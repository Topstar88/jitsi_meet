import State from'./state';import DeprecatedUtils from'./deprecatedUtils';var _isSetup=false;var _subscriptions=new Set();var _latestState=null;function _handler(state){var convertedState=DeprecatedUtils.convertState(state);_latestState=convertedState;_subscriptions.forEach(function(handler){return handler(convertedState);});}export function setup(){if(_isSetup){return;}State.add(_handler);}export function tearDown(){if(!_isSetup){return;}State.remove(_handler);_latestState=null;_subscriptions.clear();}export function latest(){if(_latestState){return Promise.resolve(_latestState);}else{return State.latest().then(function(state){_latestState=DeprecatedUtils.convertState(state);return _latestState;});}}export function add(handler){_subscriptions.add(handler);if(_latestState){handler(_latestState);}else{latest().then(handler);}}export function remove(handler){_subscriptions.delete(handler);}export default{setup:setup,tearDown:tearDown,latest:latest,add:add,remove:remove};
//# sourceMappingURL=deprecatedState.js.map